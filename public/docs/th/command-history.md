# ประวัติคำสั่ง (เรียกคืนคำสั่ง)

Marix มีฟีเจอร์ **ประวัติคำสั่ง** ที่เก็บและเรียกคืนคำสั่งที่ทำไปก่อนหน้าสำหรับแต่ละเซิร์ฟเวอร์ ช่วยให้คุณรันคำสั่งทั่วไปได้อย่างรวดเร็วโดยไม่ต้องพิมพ์ซ้ำ

## หน้าจอประวัติคำสั่ง

![หน้าจอประวัติคำสั่ง](/cmh.png)

## ฟีเจอร์

- **ประวัติต่อเซิร์ฟเวอร์**: แต่ละเซิร์ฟเวอร์มีประวัติคำสั่งของตัวเอง
- **จัดเก็บในเครื่องเท่านั้น**: คำสั่งจัดเก็บในเครื่อง ไม่เคยซิงค์หรือสำรอง
- **กรองข้อมูลละเอียดอ่อน**: กรองคำสั่งที่มีรหัสผ่าน, token หรือ secret โดยอัตโนมัติ
- **การตัดแบบ LRU**: ลบคำสั่งเก่าโดยอัตโนมัติ (สูงสุด 50 ต่อเซิร์ฟเวอร์)
- **ตัวนับการทำงาน**: ติดตามจำนวนครั้งที่ใช้แต่ละคำสั่ง
- **ค้นหา**: กรองคำสั่งอย่างรวดเร็วด้วยการค้นหาแบบ fuzzy

## วิธีเปิดใช้งาน

ประวัติคำสั่ง **ปิดใช้งานโดยค่าเริ่มต้น** เพื่อความเป็นส่วนตัว เพื่อเปิดใช้งาน:

1. เปิด **ตั้งค่า** (ไอคอนเฟืองในแถบด้านข้าง)
2. ไปที่ส่วน **Terminal**
3. สลับ **เปิดใช้งานการเรียกคืนคำสั่ง**

## การใช้งาน

### เปิดประวัติคำสั่ง

เมื่ออยู่ในเซสชันเทอร์มินัล กด:
- ปุ่ม **`Tab`** เมื่อ input ของเทอร์มินัลว่าง (เคอร์เซอร์ที่บรรทัดว่าง)
- หรือคลิกปุ่ม **ประวัติ** ในแถบเครื่องมือเทอร์มินัล

### แป้นพิมพ์ลัด

| ปุ่ม | การทำงาน |
|-----|--------|
| `Tab` (input ว่าง) | เปิด popup เรียกคืนคำสั่ง |
| `↑` / `↓` | เลื่อนดูคำสั่ง |
| `Enter` | ทำคำสั่งที่เลือก |
| `Escape` | ปิด popup |
| `Delete` / `Backspace` | ลบคำสั่งที่เลือก |

### การทำงาน Popup

- **คลิก** คำสั่งเพื่อทำทันที
- **ค้นหา** โดยพิมพ์ในช่องค้นหา
- **ลบ** คำสั่งแต่ละรายการด้วยไอคอนถังขยะ
- **บันทึกเป็น Snippet** เพื่อแปลงคำสั่งเป็น snippet ที่ใช้ซ้ำได้

## ความเป็นส่วนตัวและความปลอดภัย

### คำสั่งที่ถูกกรอง

คำสั่งที่ตรงกับรูปแบบเหล่านี้ **ไม่เคยถูกเก็บ**:

- คำสั่งที่มี `password`, `passwd`, `secret`, `token`
- คำสั่งที่มี `api_key` หรือ `apikey`
- คำสั่ง MySQL ที่มี flag `-p` (รหัสผ่าน)
- `sudo -S` (รหัสผ่าน stdin)
- คำสั่งที่ใช้ `sshpass` หรือ `expect` กับรหัสผ่าน
- Export ตัวแปรสภาพแวดล้อมที่มีค่าละเอียดอ่อน

### การจัดเก็บข้อมูล

- จัดเก็บใน `localStorage` ของเบราว์เซอร์
- **ไม่เคยซิงค์** ไปยังบริการคลาวด์
- **ไม่รวม** ในการสำรองข้อมูล
- ล้างเมื่อคุณล้างข้อมูลเบราว์เซอร์

### การล้างประวัติ

เพื่อล้างประวัติคำสั่ง:

1. เปิด **ตั้งค่า** → **Terminal**
2. คลิก **ล้างประวัติคำสั่ง**

หรือล้างต่อเซิร์ฟเวอร์จาก popup เรียกคืนคำสั่ง

## ข้อจำกัด

| ข้อจำกัด | ค่า |
|-------|-------|
| จำนวนคำสั่งสูงสุดต่อเซิร์ฟเวอร์ | 50 |
| ความยาวคำสั่งขั้นต่ำ | 2 ตัวอักษร |

## คำถามที่พบบ่อย

### ทำไมบางคำสั่งไม่ถูกบันทึก?

คำสั่งที่มีรูปแบบละเอียดอ่อน (รหัสผ่าน, token, ฯลฯ) ถูกกรองโดยอัตโนมัติเพื่อความปลอดภัย

### ฉันสามารถ export ประวัติคำสั่งได้ไหม?

ไม่ได้ ประวัติคำสั่งตั้งใจให้อยู่ในเครื่องเท่านั้นและไม่สามารถ export ได้เพื่อความเป็นส่วนตัว

### ประวัติคำสั่งซิงค์ระหว่างอุปกรณ์ไหม?

ไม่ ประวัติคำสั่งจัดเก็บในเครื่องและไม่เคยซิงค์

### ฉันจะปิดใช้งานประวัติคำสั่งได้อย่างไร?

ไปที่ ตั้งค่า → Terminal → ปิดใช้งาน "เปิดใช้งานการเรียกคืนคำสั่ง" ประวัติที่มีอยู่จะถูกเก็บไว้จนกว่าคุณจะล้างด้วยตนเอง
