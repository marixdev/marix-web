# 数据库客户端

Marix 内置数据库客户端，可直接从应用程序连接和管理数据库服务器。

## 数据库客户端界面

![Database Client Interface](/database.png)

---

## 支持的数据库

| 数据库 | 协议 | 功能 |
|----------|----------|----------|
| **MySQL / MariaDB** | `mysql` | 查询编辑器、表浏览器、数据查看器、结构检查器 |
| **PostgreSQL** | `postgresql` | 查询编辑器、表浏览器、数据查看器、结构检查器 |
| **MongoDB** | `mongodb` | 集合浏览器、文档查看器、查询接口 |
| **Redis** | `redis` | 键值浏览器、命令接口 |
| **SQLite** | `sqlite` | 本地文件支持、完整 SQL 编辑器 |

---

## 添加数据库服务器

1. 点击侧边栏中的 **+ 添加** 按钮
2. 选择 **数据库** 标签（或数据库图标）
3. 选择您的数据库类型

### MySQL / MariaDB / PostgreSQL

| 字段 | 描述 | 示例 |
|-------|-------------|---------|
| 名称 | 显示名称 | `生产环境 MySQL` |
| 主机 | 服务器主机名或 IP | `db.example.com` |
| 端口 | 数据库端口 | `3306`（MySQL）/ `5432`（PostgreSQL） |
| 用户名 | 数据库用户 | `root` |
| 密码 | 用户密码 | `••••••••` |
| 数据库 | 默认数据库（可选） | `myapp_production` |
| SSL | 启用 SSL/TLS | ☑️ 已启用 |

### MongoDB

| 字段 | 描述 | 示例 |
|-------|-------------|---------|
| 名称 | 显示名称 | `MongoDB Atlas` |
| 连接字符串 | 完整 MongoDB URI | `mongodb+srv://user:pass@cluster.mongodb.net/` |
| 主机 | 服务器主机名 | `localhost` |
| 端口 | MongoDB 端口 | `27017` |
| 数据库 | 默认数据库 | `myapp` |

### Redis

| 字段 | 描述 | 示例 |
|-------|-------------|---------|
| 名称 | 显示名称 | `Redis 缓存` |
| 主机 | 服务器主机名 | `redis.example.com` |
| 端口 | Redis 端口 | `6379` |
| 密码 | 认证密码（可选） | `••••••••` |
| 数据库 | 数据库编号 | `0` |

### SQLite

| 字段 | 描述 | 示例 |
|-------|-------------|---------|
| 名称 | 显示名称 | `本地 SQLite` |
| 文件路径 | .db 文件路径 | `/home/user/app.db` |

---

## 数据库客户端界面

### 📊 数据标签

浏览和查看表数据：

- **选择数据库**（如果有多个）
- **点击表** 在侧边栏中查看其数据
- **分页** - 浏览行（默认每页 100 行）
- **列排序** - 点击列标题排序
- **快速筛选** - 在显示的数据中搜索

### ⚡ 查询标签

编写和执行 SQL 查询，具有：

- **语法高亮** - SQL 关键字、字符串、数字
- **执行** - 使用 `Ctrl+Enter` 或执行按钮运行查询
- **结果网格** - 在表格中查看查询结果
- **导出** - 将结果下载为 CSV 或 JSON
- **执行时间** - 查看查询耗时

### 🏗️ 结构标签

检查表结构，显示：

- 列名和数据类型
- 主键、外键、唯一约束
- 可空列和默认值
- 自增设置

### 🔗 ERD 标签

查看实体关系图：

- 表和关系的可视化表示
- 外键连接显示为线条
- 拖动和缩放以浏览大型结构
- 导出为图片（PNG）

---

## 键盘快捷键

| 快捷键 | 操作 |
|----------|--------|
| `Ctrl/Cmd + Enter` | 执行查询 |
| `Ctrl/Cmd + S` | 保存查询到文件 |
| `Ctrl/Cmd + O` | 从文件打开查询 |
| `Ctrl/Cmd + Shift + F` | 格式化 SQL |
| `Escape` | 取消正在运行的查询 |

---

## 连接安全

### SSL/TLS 加密

添加服务器时启用 **SSL** 复选框。对于自定义证书：

- CA 证书路径
- 客户端证书路径（可选）
- 客户端密钥路径（可选）

### SSH 隧道

通过 SSH 隧道连接：

1. 首先在 Marix 中添加 SSH 服务器
2. 添加数据库时，启用 **SSH 隧道**
3. 选择要通过的 SSH 服务器

---

## 最佳实践

1. **使用只读账户** - 创建具有有限权限的数据库用户
2. **限制结果集** - 始终使用 `LIMIT` 避免加载过多数据
3. **执行前测试** - 对于 `UPDATE` 或 `DELETE`，先运行 `SELECT`
4. **使用事务** - 对于关键操作，包装在事务中

---

## 故障排除

| 问题 | 解决方案 |
|-------|----------|
| 连接失败 | 检查主机/端口、凭证、防火墙、SSL 设置 |
| 查询超时 | 添加 LIMIT、检查索引、检查服务器负载 |
| 权限被拒绝 | 检查授权、数据库访问权限、联系管理员 |
| SSL 证书错误 | 禁用 SSL、检查证书有效性、添加 CA 证书 |
