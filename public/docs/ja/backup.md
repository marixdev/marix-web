# バックアップと復元

暗号化されたバックアップでデータを保護します。Marix は6つのバックアッププロバイダーをサポートし、すべて Argon2id 暗号化を使用しています。

> 💡 **ヒント:** バックアップ用にクラウドアカウントを接続すると、同じデバイスでの復元時に再接続する必要はありません。認証情報はローカルに保存されます。

## バックアップと復元インターフェース

### バックアップ
![Backup Interface](/backup.png)

### 復元
![Restore Interface](/restore.png)

## バックアップ対象

- すべてのサーバーと認証情報（パスワード、秘密鍵）
- キーチェーンの SSH Key
- ポートフォワード設定
- 2FA/TOTP シークレット
- アプリケーション設定
- Cloudflare API トークン

## パスワード要件

| 要件 | 説明 |
|-------------|-------------|
| 長さ | 10文字以上 |
| 大文字 | 大文字を含める |
| 小文字 | 小文字を含める |
| 数字 | 少なくとも1つの数字を含める |
| 特殊文字 | 特殊文字を含める |

> ⚠️ **警告:** パスワードを回復することはできません。忘れた場合、バックアップに永久にアクセスできなくなります。

## ローカルバックアップ

暗号化されたバックアップファイルをコンピューターに保存します。

### ローカルバックアップを作成

1. **設定** → **「Create Backup」** をクリック
2. **Local** タブ（フォルダアイコン）を選択
3. **強力なパスワード**（10文字以上）を入力
4. パスワードを確認
5. **「Create Backup」** をクリック
6. `.marix` ファイルの保存場所を選択
7. このファイルを安全に保管

### ローカルバックアップから復元

1. **設定** → **「Restore Backup」** をクリック
2. **Local** タブを選択
3. **「Select File」** をクリックして `.marix` バックアップファイルを選択
4. バックアップ作成時に使用した**パスワード**を入力
5. **「Restore」** をクリック
6. すべてのデータが復元されてアプリケーションが再起動

## Google Drive

バックアップを Google Drive に同期します。

### 接続

1. **Google Drive** タブを選択
2. **「Connect」** をクリック
3. Google アカウントにサインイン
4. Marix に権限を付与
5. メールアドレスとともに「Connected」と表示されます

### バックアップを作成

1. 接続後、強力なパスワードを入力
2. パスワードを確認
3. **「Create Backup」** をクリック
4. ステータス: 「Backup created successfully」

### 復元

1. 既に接続している場合、アカウントは記憶されています
2. バックアップが存在する場合、「Last backup: [日付]」と表示されます
3. パスワードを入力
4. **「Restore」** をクリック

## GitHub

プライベート GitHub Gist にバックアップを保存します。

### 接続

1. **GitHub** タブを選択
2. **「Connect」** をクリック
3. **デバイスコード**が表示されます（例: `ABCD-1234`）
4. https://github.com/login/device にアクセス
5. コードを入力
6. Marix を承認

### バックアップを作成

1. 強力なパスワードを入力
2. パスワードを確認
3. **「Create Backup」** をクリック
4. バックアップはプライベート Gist として保存されます

### 復元

1. 既に接続している場合、アカウントは記憶されています
2. バックアップが存在する場合、「Last backup: [日付]」と表示されます
3. パスワードを入力
4. **「Restore」** をクリック

### バックアップの場所

https://gist.github.com → あなたのプライベート Gist → 「marix-backup」を探す

## GitLab

GitLab Snippet にバックアップを保存します。

### 接続

1. **GitLab** タブを選択
2. **「Connect」** をクリック
3. GitLab にサインイン
4. Marix を承認

### バックアップを作成

1. 強力なパスワードを入力
2. パスワードを確認
3. **「Create Backup」** をクリック
4. バックアップはプライベート Snippet として保存されます

### 復元

1. 既に接続している場合、アカウントは記憶されています
2. バックアップが存在する場合、「Last backup: [日付]」と表示されます
3. パスワードを入力
4. **「Restore」** をクリック

## Box.net

Box クラウドストレージにバックアップを保存します。

### 接続

1. **Box.net** タブを選択
2. **「Connect to Box.net」** をクリック
3. Box.net アカウントにサインイン
4. Marix を承認

### バックアップを作成

1. 強力なパスワードを入力
2. パスワードを確認
3. **「Create Backup」** をクリック

### 復元

1. 既に接続している場合、アカウントは記憶されています
2. バックアップが存在する場合、「Last backup: [日付]」と表示されます
3. パスワードを入力
4. **「Restore」** をクリック

## OneDrive

バックアップを Microsoft OneDrive に同期します。

### 接続

1. **OneDrive** タブを選択
2. **「Connect」** をクリック
3. Microsoft アカウントにサインイン
4. Marix に権限を付与
5. メールアドレスとともに「Connected」と表示されます

### バックアップを作成

1. 接続後、強力なパスワードを入力
2. パスワードを確認
3. **「Create Backup」** をクリック
4. ステータス: 「Backup created successfully」

### 復元

1. 既に接続している場合、アカウントは記憶されています
2. バックアップが存在する場合、「Last backup: [日付]」と表示されます
3. パスワードを入力
4. **「Restore」** をクリック

## プロバイダー比較

| プロバイダー | 保存場所 | メリット | デメリット |
|----------|------------------|------|------|
| **Local** | あなたのコンピューター | 完全なコントロール、オフライン | ファイルの手動管理が必要 |
| **Google Drive** | Google クラウド | 自動同期、広く使用 | Google アカウントが必要 |
| **OneDrive** | Microsoft クラウド | Windows と統合 | Microsoft アカウントが必要 |
| **GitHub** | GitHub Gist | 無料、バージョン管理 | GitHub アカウントが必要 |
| **GitLab** | GitLab Snippet | 無料、セルフホストオプション | GitLab アカウントが必要 |
| **Box.net** | Box.net クラウド | エンタープライズ向け | Box アカウントが必要 |

## ベストプラクティス

1. プロバイダーごとに**異なるパスワード**を使用
2. パスワードマネージャーに**パスワードを保存**
3. バックアップが機能することを確認するために定期的に**復元をテスト**
4. セカンダリオプションとして**ローカルバックアップを保持**
5. バックアップファイルを**共有しない** - 機密データが含まれています
6. 新しいサーバーを追加した後は定期的に**バックアップを更新**
