# ポートフォワーディング（SSH トンネル）

SSH トンネルは SSH 接続を通じてトラフィックを安全にルーティングします。

## ポートフォワーディングインターフェース

![Port Forwarding Interface](/portfoward.png)

## ポートフォワーディングの種類

| 種類 | 方向 | ユースケース |
|------|-----------|----------|
| **ローカル** | リモート → ローカル | ローカルポート経由でリモートサービスにアクセス |
| **リモート** | ローカル → リモート | ローカルサービスをリモートネットワークに公開 |
| **ダイナミック** | SOCKS プロキシ | SSH 経由で SOCKS プロキシを作成 |

## ポートフォワーディングを開く

サイドバーの **「Port Forward」** をクリック。

## ポートフォワードを作成

### ステップ 1: ダイアログを開く
**「Add Forward」** ボタンをクリック

### ステップ 2: 設定

| フィールド | 説明 | 例 |
|-------|-------------|---------|
| 名前 | わかりやすい名前 | 「MySQL to localhost」 |
| タイプ | Local、Remote、または Dynamic | Local |
| サーバー | トンネルに使用する SSH サーバー | My VPS |
| ローカルホスト | ローカルバインドアドレス | 127.0.0.1 |
| ローカルポート | ローカルポート番号 | 3307 |
| リモートホスト | リモート宛先 | 127.0.0.1 |
| リモートポート | リモートポート | 3306 |

### ステップ 3: 保存
**「Add」** または **「Save」** をクリック

## ユースケースの例

### ローカルフォワード: リモート MySQL にアクセス

ローカルマシンからサーバーの MySQL データベースにアクセス:

| 設定 | 値 |
|---------|-------|
| タイプ | Local |
| ローカル | 127.0.0.1:3307 |
| リモート | 127.0.0.1:3306 |

**使用法:** `localhost:3307` に接続してサーバーの MySQL に到達。

### リモートフォワード: ローカルアプリを公開

サーバーがあなたのローカル開発サーバーにアクセスできるようにする:

| 設定 | 値 |
|---------|-------|
| タイプ | Remote |
| ローカル | 127.0.0.1:3000 |
| リモート | 0.0.0.0:8080 |

**使用法:** サーバーのポート 8080 があなたの localhost:3000 に接続。

### ダイナミック: SOCKS プロキシ

サーバー経由でブラウジングするための SOCKS5 プロキシを作成:

| 設定 | 値 |
|---------|-------|
| タイプ | Dynamic |
| ローカル | 127.0.0.1:1080 |

**使用法:** アプリを `localhost:1080` の SOCKS5 プロキシを使用するように設定。

## ポートフォワードの管理

### 開始
1. リストでフォワードを見つける
2. **Start** ボタン（▶）をクリック
3. ステータスが「Connected」に変わる

### 停止
1. 実行中のフォワードを見つける
2. **Stop** ボタン（■）をクリック
3. ステータスが「Disconnected」に変わる

### 編集
1. 実行中の場合は**停止**
2. **Edit** ボタン（鉛筆）をクリック
3. 設定を変更
4. **Save** をクリック

### 削除
1. 実行中の場合は停止
2. **Delete** ボタン（ゴミ箱）をクリック
3. 削除を確認

## ステータスの監視

リストには以下が表示されます:
- **ステータスインジケーター**: 緑 = 接続中、赤 = エラー
- **接続数**: アクティブな接続数
- **転送バイト数**: 入出力トラフィック

## 一般的なユースケース

| サービス | ローカルポート | リモートポート | タイプ |
|---------|------------|-------------|------|
| MySQL | 3307 | 3306 | Local |
| PostgreSQL | 5433 | 5432 | Local |
| Redis | 6380 | 6379 | Local |
| MongoDB | 27018 | 27017 | Local |
| Web アプリ | 8080 | 80 | Local |
| Jupyter | 8889 | 8888 | Local |

## トラブルシューティング

### ポートが既に使用中
- 別のローカルポートを選択
- 別のアプリケーションがそのポートを使用していないか確認
- 競合するサービスを停止

### 接続拒否
- リモートサービスが起動しているか確認
- サーバーのファイアウォールを確認
- 正しいリモートホスト/ポートを確認

### トンネルが切断
- SSH 接続の安定性を確認
- サーバーにタイムアウト設定がある可能性
- キープアライブの使用を検討
