# История команд (Вызов команд)

Marix предоставляет функцию **Истории команд**, которая сохраняет и вызывает ранее выполненные команды для каждого сервера. Это помогает быстро повторно выполнять часто используемые команды без повторного ввода.

## Интерфейс истории команд

![Интерфейс истории команд](/cmh.png)

## Возможности

- **История по серверам**: Каждый сервер хранит свою историю команд
- **Только локальное хранение**: Команды хранятся локально, никогда не синхронизируются и не резервируются
- **Фильтрация конфиденциальных данных**: Автоматически отфильтровывает команды, содержащие пароли, токены или секреты
- **LRU-очистка**: Автоматически удаляет старые команды (максимум 50 на сервер)
- **Счётчик выполнений**: Отслеживает, сколько раз использовалась каждая команда
- **Поиск**: Быстрый поиск команд с нечётким соответствием

## Как включить

История команд **отключена по умолчанию** для конфиденциальности. Чтобы включить:

1. Откройте **Настройки** (значок шестерёнки в боковой панели)
2. Перейдите в раздел **Терминал**
3. Включите **Вызов команд**

## Использование

### Открытие истории команд

В терминальной сессии нажмите:
- Клавишу **`Tab`** когда ввод терминала пуст (курсор на пустой строке)
- Или нажмите кнопку **История** на панели инструментов терминала

### Горячие клавиши

| Клавиша | Действие |
|---------|----------|
| `Tab` (пустой ввод) | Открыть всплывающее окно истории |
| `↑` / `↓` | Навигация по командам |
| `Enter` | Выполнить выбранную команду |
| `Escape` | Закрыть всплывающее окно |
| `Delete` / `Backspace` | Удалить выбранную команду |

### Действия во всплывающем окне

- **Нажмите** на команду для немедленного выполнения
- **Поиск** вводом в поле поиска
- **Удаление** отдельных команд значком корзины
- **Сохранить как сниппет** для преобразования команды в многоразовый сниппет

## Конфиденциальность и безопасность

### Отфильтрованные команды

Команды, соответствующие этим шаблонам, **никогда не сохраняются**:

- Команды, содержащие `password`, `passwd`, `secret`, `token`
- Команды с `api_key` или `apikey`
- Команды MySQL с флагом `-p` (пароль)
- `sudo -S` (пароль через stdin)
- Команды с использованием `sshpass` или `expect` с паролем
- Экспорт переменных окружения с конфиденциальными значениями

### Хранение данных

- Хранится в `localStorage` браузера
- **Никогда не синхронизируется** с облачными сервисами
- **Никогда не включается** в резервные копии
- Очищается при очистке данных браузера

### Очистка истории

Чтобы очистить историю команд:

1. Откройте **Настройки** → **Терминал**
2. Нажмите **Очистить историю команд**

Или очистите для каждого сервера из всплывающего окна истории.

## Ограничения

| Ограничение | Значение |
|-------------|----------|
| Макс. команд на сервер | 50 |
| Мин. длина команды | 2 символа |

## Часто задаваемые вопросы

### Почему некоторые команды не сохраняются?

Команды, содержащие конфиденциальные шаблоны (пароли, токены и т.д.), автоматически фильтруются для безопасности.

### Можно ли экспортировать историю команд?

Нет, история команд намеренно только локальная и не экспортируется по соображениям конфиденциальности.

### Синхронизируется ли история команд между устройствами?

Нет, история команд хранится локально и никогда не синхронизируется.
