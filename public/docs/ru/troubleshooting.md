# Устранение неполадок

Руководство по решению распространённых проблем с Marix.

## Проблемы с подключением

### Не удаётся подключиться к серверу

**Симптомы:**
- Ошибка «Connection refused» (Соединение отклонено)
- Ошибка «Connection timed out» (Превышено время ожидания)
- Ошибка «Host unreachable» (Хост недоступен)

**Решения:**

1. **Проверьте IP-адрес и порт**
   - Убедитесь, что адрес сервера правильный
   - Проверьте, что порт SSH открыт (по умолчанию 22)

2. **Проверьте сетевое соединение**
   - Убедитесь, что у вас есть доступ в интернет
   - Попробуйте ping к серверу
   - Проверьте настройки VPN, если используете

3. **Проверьте брандмауэр**
   - Убедитесь, что SSH-порт не заблокирован
   - Проверьте настройки брандмауэра на сервере
   - Проверьте настройки сетевого оборудования

4. **Проверьте статус сервера**
   - Убедитесь, что сервер включён
   - Проверьте, что SSH-сервис запущен

### Ошибка аутентификации

**Симптомы:**
- Ошибка «Permission denied» (Доступ запрещён)
- Ошибка «Authentication failed» (Ошибка аутентификации)

**Решения:**

1. **Проверьте учётные данные**
   - Убедитесь, что имя пользователя правильное
   - Проверьте правильность пароля
   - Учитывайте регистр символов

2. **Для SSH-ключей**
   - Убедитесь, что публичный ключ добавлен на сервер
   - Проверьте права на `~/.ssh` (700) и `authorized_keys` (600)
   - Убедитесь, что выбран правильный ключ

3. **Проверьте настройки сервера**
   - Убедитесь, что аутентификация по паролю разрешена (если используете пароль)
   - Проверьте `PasswordAuthentication` в `/etc/ssh/sshd_config`

### Соединение разрывается

**Симптомы:**
- Сессия внезапно закрывается
- Ошибка «Connection reset» (Соединение сброшено)
- Ошибка «Broken pipe» (Разрыв связи)

**Решения:**

1. **Настройте Keep-Alive**
   - Включите Keep-Alive в настройках подключения
   - Установите интервал 30-60 секунд

2. **Проверьте стабильность сети**
   - Используйте проводное соединение вместо Wi-Fi
   - Проверьте качество интернет-соединения

3. **Проверьте настройки сервера**
   - Проверьте `ClientAliveInterval` в sshd_config
   - Увеличьте `ClientAliveCountMax`

## Проблемы с отображением

### Некорректное отображение символов

**Симптомы:**
- Вместо символов отображаются квадраты или вопросительные знаки
- Неправильное отображение кириллицы
- Проблемы с эмодзи

**Решения:**

1. **Проверьте кодировку**
   - Установите UTF-8 в настройках терминала
   - Убедитесь, что сервер использует UTF-8

2. **Проверьте шрифт**
   - Используйте шрифт с поддержкой нужных символов
   - Рекомендуемые: JetBrains Mono, Fira Code, Hack

3. **Проверьте локаль сервера**
   ```bash
   locale
   # Должно быть что-то вроде: LANG=en_US.UTF-8
   ```

### Неправильные цвета

**Симптомы:**
- Цвета не отображаются
- Неправильные цвета в приложениях

**Решения:**

1. **Проверьте переменную TERM**
   ```bash
   echo $TERM
   # Рекомендуется: xterm-256color
   ```

2. **Установите TERM**
   - В настройках сессии укажите `xterm-256color`
   - Или добавьте в `.bashrc`: `export TERM=xterm-256color`

### Проблемы с размером терминала

**Симптомы:**
- Текст обрезается
- Неправильный перенос строк
- Приложения (vim, htop) отображаются некорректно

**Решения:**

1. **Измените размер окна**
   - Измените размер окна терминала
   - Приложение должно автоматически адаптироваться

2. **Принудительно обновите размер**
   - Выполните команду: `resize`
   - Или нажмите `Ctrl+L` для обновления экрана

## Проблемы с SFTP

### Не удаётся загрузить или скачать файл

**Симптомы:**
- Ошибка при передаче файла
- Передача зависает

**Решения:**

1. **Проверьте права доступа**
   - Убедитесь, что у вас есть права на запись в целевую директорию
   - Проверьте права на исходный файл

2. **Проверьте свободное место**
   - Убедитесь, что достаточно места на диске
   - Команда: `df -h`

3. **Проверьте размер файла**
   - Большие файлы могут требовать больше времени
   - Проверьте ограничения сервера

### Файлы не отображаются

**Решения:**

1. **Обновите директорию**
   - Нажмите кнопку обновления
   - Или нажмите `Ctrl+R`

2. **Проверьте права**
   - У вас должны быть права на чтение директории

3. **Проверьте скрытые файлы**
   - Включите отображение скрытых файлов (начинающихся с точки)

## Проблемы с производительностью

### Медленная работа терминала

**Решения:**

1. **Уменьшите буфер прокрутки**
   - Большой буфер может замедлять работу
   - Установите разумное значение (10000 строк)

2. **Отключите ненужные функции**
   - Отключите прозрачность фона
   - Отключите анимации

3. **Проверьте сетевое соединение**
   - Используйте более быстрый интернет
   - Используйте сжатие SSH

### Высокое потребление памяти

**Решения:**

1. **Закройте неиспользуемые вкладки**
   - Каждая вкладка потребляет память

2. **Очистите буфер терминала**
   - Команда: `clear` или `Ctrl+L`

3. **Перезапустите приложение**
   - Периодически перезапускайте для освобождения памяти

## Проблемы с ключами

### Ключ не принимается сервером

**Решения:**

1. **Проверьте формат ключа**
   - Убедитесь, что используете правильный тип ключа
   - Сервер может не поддерживать некоторые типы

2. **Проверьте права на сервере**
   ```bash
   chmod 700 ~/.ssh
   chmod 600 ~/.ssh/authorized_keys
   ```

3. **Проверьте SELinux**
   ```bash
   restorecon -R ~/.ssh
   ```

### Запрашивается парольная фраза при каждом подключении

**Решения:**

1. **Это нормальное поведение**
   - Парольная фраза защищает ключ

2. **Используйте SSH-агент**
   - Ключ будет разблокирован один раз за сессию

## Общие советы

### Сбор информации для отчёта об ошибке

1. **Запишите точное сообщение об ошибке**
2. **Укажите версию приложения**
3. **Опишите шаги для воспроизведения**
4. **Приложите логи (если возможно)**

### Логи сервера

Для диагностики проверьте логи на сервере:

```bash
# Логи аутентификации
sudo tail -f /var/log/auth.log

# Логи SSH
sudo journalctl -u sshd -f
```

### Сброс настроек

Если ничего не помогает:

1. **Сбросьте настройки сессии** — Удалите проблемный сервер и создайте заново
2. **Очистите кэш приложения** — В настройках приложения
3. **Переустановите приложение** — Как крайняя мера

## Получение помощи

Если проблема не решена:

1. **Проверьте документацию** — Возможно, ответ уже есть
2. **Поищите в FAQ** — Часто задаваемые вопросы
3. **Обратитесь в поддержку** — С подробным описанием проблемы
4. **Сообщите об ошибке** — Если нашли баг
