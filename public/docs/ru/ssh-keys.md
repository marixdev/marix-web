# Менеджер SSH-ключей

Создавайте, импортируйте и управляйте SSH-ключами для безопасной аутентификации.

## Обзор

SSH-ключи обеспечивают:
- Безопасную аутентификацию без паролей
- Более высокий уровень безопасности
- Удобный вход на серверы
- Автоматизацию подключений

## Открытие менеджера ключей

1. Перейдите в **Меню** → **SSH-ключи**
2. Или нажмите на иконку ключа в панели инструментов

## Создание нового ключа

### Шаг 1: Начало создания

1. Нажмите **+ Создать ключ**
2. Откроется диалог создания ключа

### Шаг 2: Настройка параметров

| Параметр | Описание | Рекомендация |
|----------|----------|--------------|
| **Имя** | Описательное имя ключа | Например, «Рабочий сервер» |
| **Тип** | Алгоритм ключа | ED25519 (рекомендуется) |
| **Размер** | Длина ключа в битах | 4096 для RSA |
| **Парольная фраза** | Дополнительная защита | Рекомендуется |

### Шаг 3: Типы ключей

| Тип | Описание | Безопасность |
|-----|----------|--------------|
| **ED25519** | Современный, быстрый | Высокая |
| **RSA** | Классический, совместимый | Высокая (4096 бит) |
| **ECDSA** | Эллиптические кривые | Высокая |

### Шаг 4: Создание

1. Заполните параметры
2. Нажмите **Создать**
3. Ключ появится в списке

## Импорт существующего ключа

### Из файла

1. Нажмите **Импорт**
2. Выберите **Из файла**
3. Укажите файл приватного ключа (например, `id_rsa`)
4. Введите парольную фразу (если есть)
5. Нажмите **Импорт**

### Из буфера обмена

1. Нажмите **Импорт**
2. Выберите **Из буфера**
3. Вставьте содержимое приватного ключа
4. Введите парольную фразу (если есть)
5. Нажмите **Импорт**

## Использование ключей

### Назначение ключа серверу

1. Откройте настройки сервера
2. Перейдите в раздел **Аутентификация**
3. Выберите **SSH-ключ**
4. Выберите ключ из списка
5. Сохраните настройки

### Подключение

При подключении к серверу:
1. Marix автоматически использует назначенный ключ
2. При наличии парольной фразы — запросит её ввод
3. Подключение устанавливается

## Копирование публичного ключа

### На сервер вручную

1. Найдите ключ в списке
2. Нажмите **Показать публичный ключ**
3. Скопируйте содержимое
4. Добавьте в `~/.ssh/authorized_keys` на сервере

### Автоматическая установка

1. Выберите ключ в списке
2. Нажмите **Установить на сервер**
3. Выберите сервер из списка
4. Введите пароль (для первого подключения)
5. Ключ автоматически добавится на сервер

## Управление ключами

### Переименование

1. Найдите ключ в списке
2. Нажмите **Редактировать** (карандаш)
3. Измените имя
4. Нажмите **Сохранить**

### Изменение парольной фразы

1. Найдите ключ в списке
2. Нажмите **Изменить парольную фразу**
3. Введите текущую парольную фразу
4. Введите новую парольную фразу
5. Подтвердите новую парольную фразу
6. Нажмите **Сохранить**

### Экспорт ключа

1. Найдите ключ в списке
2. Нажмите **Экспорт**
3. Выберите формат:
   - **OpenSSH** — Стандартный формат
   - **PuTTY (PPK)** — Для PuTTY
4. Сохраните файл

### Удаление ключа

1. Найдите ключ в списке
2. Нажмите **Удалить** (корзина)
3. Подтвердите удаление

> **Внимание:** Удаление ключа не удаляет его с серверов. Уберите публичный ключ из `authorized_keys` на серверах вручную.

## Безопасность ключей

### Рекомендации

- **Используйте парольную фразу** — Защищает ключ при краже
- **Используйте ED25519** — Современный и безопасный
- **Отдельные ключи** — Для разных целей
- **Резервные копии** — Сохраняйте в безопасном месте
- **Регулярная ротация** — Меняйте ключи периодически

### Хранение ключей

Ключи хранятся:
- В зашифрованном хранилище приложения
- С дополнительным шифрованием парольной фразой
- Локально на устройстве

## Устранение неполадок

### Ключ не принимается сервером

1. Проверьте права на `~/.ssh` (700) и `authorized_keys` (600)
2. Убедитесь, что публичный ключ правильно скопирован
3. Проверьте, включена ли аутентификация по ключам в sshd_config

### Запрашивается пароль вместо ключа

1. Убедитесь, что ключ назначен серверу
2. Проверьте соответствие приватного и публичного ключей
3. Проверьте логи сервера (`/var/log/auth.log`)

### Ошибка формата ключа

1. Убедитесь, что импортируете приватный ключ
2. Проверьте формат файла (OpenSSH, PuTTY)
3. Попробуйте конвертировать ключ

## Советы

- Создавайте отдельные ключи для работы и личного использования
- Храните резервную копию ключей в безопасном месте
- Используйте понятные имена для ключей
- Регулярно проверяйте, какие ключи установлены на серверах
